{
  "feature": "Fund Detail View",
  "version": "1.1",
  "created": "2026-01-14",
  "updated": "2026-01-15",
  "goal": "Comprehensive fund detail view with stats, transactions, and quick actions tailored to fund type",
  "spec": {
    "overview": "The fund detail view (`/fund/[id]`) displays a single fund's status, recent activity, and provides contextual actions. Layout adapts based on fund type (SPENDING vs NON_NEGOTIABLE) and timeMode.",
    "design": "## Sections\n\n### 1. Header\n- Fund name (inline editable via TextInput)\n- Folder badge (visual only, not tappable)\n- Close button\n- Auto-save: debounce 500ms + on-blur\n\n### 2. Stats Overview\n\n**SPENDING funds:**\n- Progress bar showing spent/budgeted\n- Quick-stat cycling: remaining → percentage → spent\n- Over-budget: red progress bar + 'overspent' label (existing dashboard pattern)\n- Period label + 'Resets in X days'\n\n**NON_NEGOTIABLE funds:**\n- Savings progress bar toward goal\n- Mark as Paid button (enabled when fully funded)\n- Post-paid state: 'Paid on [date]' confirmation badge\n- Period label + 'Resets in X days'\n\n**EVENTUALLY funds:**\n- Goal-focused framing: 'X away from goal'\n- No reset countdown\n- Progress toward total goal amount\n\n### 3. Recent Transactions\n- Show 5 most recent transactions for this fund\n- Each row: store/note, amount, date\n- Empty state: 'No transactions yet' (simple text)\n- 'See all' link → `/fund/[id]/transactions`\n\n### 4. Quick Actions\n- **Add Expense**: Navigate to add-expense with fund pre-selected\n- **Mark as Paid**: NON_NEGOTIABLE only, shows when fully funded\n- **Delete Fund**: iOS action sheet with destructive confirmation\n- **Archive Fund**: iOS action sheet (alternative to delete)\n\n### 5. Fund Transactions Route (`/fund/[id]/transactions`)\n- Simple paginated list of all transactions for this fund\n- Grouped by date\n- No stats header (just transaction list)\n- Uses existing TransactionList component pattern",
    "api": "## Existing Endpoints\n- `fund.retrieve` - Get fund details\n- `transaction.recentByFund` - Get recent transactions (returns 10, show 5)\n- `transaction.markAsPaid` - Mark non-negotiable as paid\n- `fund.update` - Update fund name\n- `fund.delete` - Delete fund\n\n## New Endpoints Needed\n- `transaction.listByFund` - Paginated transactions for a single fund (for /fund/[id]/transactions route)",
    "files": [
      {
        "action": "modify",
        "path": "apps/mobile/src/app/(app)/fund/[id].tsx",
        "purpose": "Main fund detail screen with stats, transactions, quick actions"
      },
      {
        "action": "create",
        "path": "apps/mobile/src/app/(app)/fund/[id]/transactions.tsx",
        "purpose": "Fund-specific transactions list route"
      },
      {
        "action": "modify",
        "path": "packages/api/src/router/transactions.ts",
        "purpose": "Add listByFund endpoint for paginated fund transactions"
      }
    ],
    "deferred": [
      "Budget amount inline editing",
      "Spending trends chart",
      "Period comparison stats",
      "Transfer between funds feature"
    ]
  },
  "items": [
    {
      "id": "FDV-001",
      "category": "API",
      "description": "Add `transaction.listByFund` endpoint with cursor pagination",
      "steps_to_verify": [
        "Endpoint accepts fundId and cursor params",
        "Returns paginated transactions for specified fund",
        "Transactions ordered by date descending"
      ],
      "passes": true
    },
    {
      "id": "FDV-002",
      "category": "UI Component",
      "description": "Implement editable fund name header with auto-save",
      "steps_to_verify": [
        "TextInput displays current fund name",
        "Debounces input (500ms) before saving",
        "Also saves on blur/keyboard dismiss",
        "Shows loading/success feedback"
      ],
      "passes": false
    },
    {
      "id": "FDV-003",
      "category": "UI Component",
      "description": "Implement stats overview for SPENDING funds",
      "steps_to_verify": [
        "Shows spent/budgeted amounts",
        "Progress bar reflects usage percentage",
        "Over-budget shows red bar + 'overspent' quick-stat",
        "Shows period label and reset countdown"
      ],
      "passes": true
    },
    {
      "id": "FDV-004",
      "category": "UI Component",
      "description": "Implement stats overview for NON_NEGOTIABLE funds",
      "steps_to_verify": [
        "Shows savings progress toward goal",
        "Mark as Paid button enabled when fully funded",
        "Post-paid state shows 'Paid on [date]' confirmation",
        "Shows period label and reset countdown"
      ],
      "passes": false
    },
    {
      "id": "FDV-005",
      "category": "UI Component",
      "description": "Implement stats overview for EVENTUALLY funds",
      "steps_to_verify": [
        "Goal-focused display: 'X away from goal'",
        "Progress bar shows total progress",
        "No reset countdown displayed"
      ],
      "passes": false
    },
    {
      "id": "FDV-006",
      "category": "UI Component",
      "description": "Implement recent transactions section",
      "steps_to_verify": [
        "Shows 5 most recent transactions",
        "Each row displays store/note, amount, date",
        "Empty state shows 'No transactions yet'",
        "'See all' navigates to /fund/[id]/transactions"
      ],
      "passes": false
    },
    {
      "id": "FDV-007",
      "category": "UI Component",
      "description": "Implement quick actions section",
      "steps_to_verify": [
        "Add Expense navigates with fund pre-selected",
        "Mark as Paid works for funded NON_NEGOTIABLE funds",
        "Delete shows iOS action sheet with confirmation",
        "Archive shows iOS action sheet with confirmation"
      ],
      "passes": false
    },
    {
      "id": "FDV-008",
      "category": "Screen",
      "description": "Create /fund/[id]/transactions route",
      "steps_to_verify": [
        "Shows all transactions for the fund",
        "Paginated with load-more",
        "Grouped by date",
        "Uses existing TransactionList patterns"
      ],
      "passes": false
    }
  ]
}
