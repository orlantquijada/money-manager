{
  "feature": "nested-native-tabs",
  "version": "1.0",
  "created": "2026-01-18",
  "goal": "Swipe right from any tab root to access add-expense, with native iOS liquid glass tabs",
  "spec": {
    "overview": "Restructure navigation into a 2-screen MaterialTopTabs (add-expense + main) where main contains NativeTabs for dashboard/spending/transactions. This enables full-screen swipe-right to add-expense while using iOS native tab bar.",
    "design": "## Current Architecture\n```\n(tabs)/_layout.tsx → MaterialTopTabs (4 screens)\n├── add-expense (index 0, hidden from tab bar)\n├── (dashboard) (nested Expo UI Tabs)\n├── spending\n└── transactions\n\nCustom TabBar: Glass pill (3 icons) + FAB (+)\nSwipe: Between ALL 4 screens horizontally\n```\n\n## Target Architecture\n```\n(tabs)/_layout.tsx → MaterialTopTabs (2 screens)\n├── add-expense (index 0)\n└── (main)/_layout.tsx → NativeTabs (index 1)\n    ├── (dashboard)/ (keeps nested Expo UI Tabs)\n    ├── spending\n    └── transactions\n\nFAB: Floats above NativeTabs (absolute positioned)\nSwipe: Only between add-expense ↔ (main)\n```\n\n## Key Behaviors\n- **Swipe right** from dashboard/spending/transactions → navigates to add-expense\n- **Swipe left** from add-expense → returns to previous tab\n- **Tap FAB (+)** → navigates to add-expense\n- **Swipe blocked** in nested stacks (fund details, transaction details)\n- **NativeTabs** uses iOS 26 liquid glass, minimizeBehavior onScrollDown\n- **Dashboard** keeps existing nested tabs (budgets/activity)\n\n## Transition Animation\n- Keep current horizontal slide with blur overlay\n- Position context simplified to 2-screen model (0 = add-expense, 1 = main)\n- AnimatedTabScreen/AnimatedBlurOverlay adapted for 2-screen setup",
    "api": "No API changes. Navigation-only refactor.",
    "files": [
      {
        "action": "create",
        "path": "apps/mobile/src/app/(app)/(tabs)/(main)/_layout.tsx",
        "purpose": "NativeTabs layout for dashboard/spending/transactions"
      },
      {
        "action": "move",
        "path": "apps/mobile/src/app/(app)/(tabs)/(dashboard)",
        "purpose": "Move into (main) folder"
      },
      {
        "action": "move",
        "path": "apps/mobile/src/app/(app)/(tabs)/spending.tsx",
        "purpose": "Move into (main) folder"
      },
      {
        "action": "move",
        "path": "apps/mobile/src/app/(app)/(tabs)/transactions",
        "purpose": "Move into (main) folder"
      },
      {
        "action": "modify",
        "path": "apps/mobile/src/app/(app)/(tabs)/_layout.tsx",
        "purpose": "Reduce to 2 screens: add-expense + (main)"
      },
      {
        "action": "modify",
        "path": "apps/mobile/src/components/tab-bar.tsx",
        "purpose": "Convert to FAB-only component, remove icon pill"
      },
      {
        "action": "modify",
        "path": "apps/mobile/src/contexts/tab-position-context.tsx",
        "purpose": "Simplify for 2-screen model"
      },
      {
        "action": "modify",
        "path": "apps/mobile/src/components/animated-blur-overlay.tsx",
        "purpose": "Adapt for 2-screen transition"
      }
    ]
  },
  "items": [
    {
      "id": "NAV-001",
      "category": "Structure",
      "description": "Create (main) folder and move existing tab screens into it",
      "steps_to_verify": [
        "(dashboard), spending, transactions folders exist under (main)/",
        "Old locations removed",
        "App builds without errors"
      ],
      "passes": false
    },
    {
      "id": "NAV-002",
      "category": "Navigation",
      "description": "Implement NativeTabs layout for (main)",
      "steps_to_verify": [
        "NativeTabs renders with 3 triggers: Home, Insights, History",
        "SF Symbols icons display correctly",
        "Liquid glass effect visible on iOS",
        "minimizeBehavior works on scroll"
      ],
      "passes": false
    },
    {
      "id": "NAV-003",
      "category": "Navigation",
      "description": "Update outer MaterialTopTabs to 2-screen model",
      "steps_to_verify": [
        "Only add-expense and (main) as screens",
        "Swipe right from any NativeTab root goes to add-expense",
        "Swipe left from add-expense returns to (main)"
      ],
      "passes": false
    },
    {
      "id": "NAV-004",
      "category": "UI Component",
      "description": "Convert TabBar to FAB-only overlay",
      "steps_to_verify": [
        "Glass pill with 3 icons removed",
        "FAB (+) button floats above NativeTabs",
        "FAB slides down when on add-expense screen",
        "Tapping FAB navigates to add-expense"
      ],
      "passes": false
    },
    {
      "id": "NAV-005",
      "category": "Animation",
      "description": "Adapt position context and blur overlay for 2-screen model",
      "steps_to_verify": [
        "Blur overlay animates during swipe transition",
        "No visual glitches during add-expense → main transition",
        "AnimatedTabScreen scale/borderRadius effects work"
      ],
      "passes": false
    },
    {
      "id": "NAV-006",
      "category": "Gesture",
      "description": "Block swipe gesture in nested stacks",
      "steps_to_verify": [
        "Cannot swipe to add-expense from fund detail screen",
        "Cannot swipe to add-expense from transaction detail screen",
        "Swipe only works at tab root level"
      ],
      "passes": false
    },
    {
      "id": "NAV-007",
      "category": "Polish",
      "description": "Remove dead code and unused components",
      "steps_to_verify": [
        "Old TabBar icon components removed",
        "Unused position tracking logic removed",
        "No TypeScript errors",
        "No console warnings"
      ],
      "passes": false
    }
  ]
}
